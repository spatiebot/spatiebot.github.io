!function(t){var e={};function s(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,s),o.l=!0,o.exports}s.m=t,s.c=e,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)s.d(i,o,function(e){return t[e]}.bind(null,o));return i},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=1)}([function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i={announce:function(t){i.log("Announce: "+t),Network.sendChat(t)},calcDiff:function(t,e){var s=e.x-t.x,i=t.y-e.y;return{diffX:s,diffY:i,distance:Math.sqrt(s*s+i*i)}},decodeHtml:function(t){var e=i;return e.htmlDecodeHelper=e.htmlDecodeHelper||document.createElement("textarea"),e.htmlDecodeHelper.innerHTML=t,e.htmlDecodeHelper.value},getPlayers:function(){var t=[],e=Players.getIDs();for(var s in e)if(e.hasOwnProperty(s)){var i=Players.get(s);i&&t.push(i)}return t},getRandomNumber:function(t,e){return t+Math.floor(Math.random()*(e-t))},log:function(t){if(i.shouldLog){var e=i;e.logger||(e.logger=document.createElement("textarea"),document.body.appendChild(e.logger),e.logger.style="position: absolute; top: 1px; left: 1px;"),e.logger.innerHTML=t+"\n"+e.logger.innerHTML}},shouldLog:!1};e.Spatie=i},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s(0),o=s(2),a=null,n=!1;SWAM.registerExtension({name:"SpatieBot 2.0",id:"spatie02",description:"Runs one bot",author:"Spatie",version:"3.0",settingsProvider:function(){var t=new SettingsProvider({limitUpdates:!1},function(t){n=t.limitUpdates});return t.addSection("SpatieBot settings").addBoolean("limitUpdates","Don't update screen when window doesn't have focus (for hosting many bots)"),t}()}),SWAM.on("gamePrep",function(){console.log("Press 'B' to toggle bot");var t=Mobs.add;Mobs.add=function(e,s,i){t.apply(null,arguments),a&&a.onMobAdd(i,e)};var e=UI.updateUpgrades;UI.updateUpgrades=function(t,s,i){e.apply(null,arguments),a&&(a.upgradeInfo.availableUpgrades=s,a.upgradeInfo.upgradeStats=t)};var s=UI.showMessage;UI.showMessage=function(t,e,i){s.apply(null,arguments),/upgrade/.exec(e)&&a&&(a.upgradeInfo.availableUpgrades=a.upgradeInfo.availableUpgrades||0,a.upgradeInfo.availableUpgrades+=1)};var i=Graphics.render;Graphics.render=function(){n&&!document.hasFocus()||i.apply(null,arguments)}}),SWAM.on("keyup",function(t){var e=t.originalEvent.key;"B"!==e&&"b"!==e||(a?(a.dispose(),a=null):(a=function(){var t=new o.SpatieBot;return Window.Spatie=i.Spatie,Window.SpatieBot=t,t}()).initialize())}),SWAM.on("playerKilled",function(t,e,s){a&&a.onPlayerKilled(e.id,s.id)}),SWAM.on("chatLineAdded",function(t,e,s){if(console.log(t.name+": "+e),a)if("-sb-bond"===e)a.toggleBonding();else if("-sb-target"===e)a.announceTarget();else{var i=/-sb-suggest[: ]+(.*)/.exec(e);if(i){var o=i[1];a.suggestVictim(t.id,o)}}})},function(t,e,s){"use strict";var i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,s=1,i=arguments.length;s<i;s++)for(var o in e=arguments[s])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var o=s(3),a=s(0),n=s(4),r=s(5),c=new o.BotConfigFactory,l={availableUpgrades:0,upgradeStats:{}},h=function(){function t(){this.upgradeInfo=l}return t.prototype.announceTarget=function(){if(this.isOn()){var t=this.state.victim,e=t?t.name:"(no target)";a.Spatie.announce("Target: "+e)}},t.prototype.dispose=function(){this.state&&this.state.heartbeatInterval&&(clearInterval(this.state.heartbeatInterval),this.commandExecutor.clearCommands(),this.commandExecutor=null,this.state=null)},t.prototype.initialize=function(){var t=this;this.isOn()||(this.state=new n.SpatiebotState,this.config=c.getConfigByAircraftType(Players.getMe().type),this.commandExecutor=new r.SpatiebotCommandExecutor(this.state,this.config),a.Spatie.log("Starting bot of type "+this.config.name),this.config.bondingTimes>0&&(this.config.bondingTimes=this.config.bondingTimes-1),this.state.heartbeatInterval=setInterval(function(){return t.heartbeat()},this.config.heartbeatInterval))},t.prototype.logState=function(){this.isOn()?a.Spatie.log(JSON.stringify(this.state)):a.Spatie.log("(no state: bot is off)")},t.prototype.onMissileFired=function(t){this.isOn()&&(this.state.missileIDs=this.state.missileIDs||[],this.state.missileIDs.push(t))},t.prototype.onMobAdd=function(t,e){if(this.isOn()&&t!==game.myID){[1,2,3,5,6,7].indexOf(e.type)>-1?this.onMissileFired(e.id):[4,8,9].indexOf(e.type)>-1&&this.onPowerupDetected(e.id)}},t.prototype.onPlayerKilled=function(t,e){var s=this;this.isOn()&&(t===game.myID?(a.Spatie.log("I was killed. Restarting."),this.dispose(),setTimeout(function(){return s.initialize()},this.config.respawnTimeout)):this.state.victim&&t===this.state.victim.id&&(a.Spatie.log("Victim was killed, choosing another victim."),this.state.victim=null))},t.prototype.onPowerupDetected=function(t){this.isOn()&&this.config.goForUpgrades&&(this.state.detectedPowerUps=this.state.detectedPowerUps||[],this.state.detectedPowerUps.push(t))},t.prototype.toggleBonding=function(){this.isOn()&&(this.config.bondingTimes?(this.config.bondingTimes=null,a.Spatie.announce("Every SpatieBot for itself")):(this.config.bondingTimes=3,this.state.victim=null,a.Spatie.announce("All SpatieBots, unite!")))},t.prototype.suggestVictim=function(t,e){var s,i;this.isOn()&&(0!==a.Spatie.getRandomNumber(0,4)&&(s=Players.getByName(e)).id!==game.myID&&(this.state.suggestedVictimID=s?s.id:null,i=!0),s?a.Spatie.announce("ok, new target: "+e):(this.state.suggestedVictimID=t,i||a.Spatie.announce("ok, new target: "+Players.get(t).name)))},t.prototype.applyUpgrades=function(){var t=this,e=!1;this.state.lastUpgradeApplicationTime&&(e=Date.now()-this.state.lastUpgradeApplicationTime<5e3);var s=this.upgradeInfo.availableUpgrades>=5,i=Players.getMe().health>=.9;if(!e&&s&&i){var o=0;this.state.lastUpgradeApplicationTime=Date.now();var a=setInterval(function(){Network.sendCommand("upgrade",t.config.applyUpgradesTo+""),5===(o+=1)&&clearInterval(a)},400)}},t.prototype.approachCoords=function(){var t={pos:this.state.gotoCoords};this.turnTo(t),this.getDeltaTo(t).distance>this.config.distanceClose?(this.setFastMovement(!0),this.setSpeedMovement("UP")):this.state.gotoCoords=null},t.prototype.approachMob=function(){for(var t,e=[],s=0;s<this.state.detectedPowerUps.length;s++){var i=Mobs.get(this.state.detectedPowerUps[s]);i&&(e.push(i.id),i.delta=this.getDeltaTo(i),(!t||t.delta.distance>i.delta.distance)&&(t=i))}t&&(this.turnTo(t),t.delta.distance>this.config.distanceTooClose&&this.setFastMovement(!0),this.setSpeedMovement("UP")),this.state.detectedPowerUps=e},t.prototype.approachVictim=function(){var t=this.state.victim;if(t){var e,s=this.getDeltaTo(t);this.setFastMovement(!1),this.state.isVictimPoweredUp&&s.distance<this.config.distanceNear&&!this.hasShield()?e="DOWN":s.distance>this.config.distanceFar?(Players.getMe().health>this.config.fleeHealthThresholdMax&&this.setFastMovement(!0),e="UP"):e=s.distance>this.config.distanceTooClose?"UP":"DOWN",this.setSpeedMovement(e)}else this.setSpeedMovement(null)},t.prototype.chooseNextVictim=function(){var t=this.getHostilePlayersSortedByDistance(this.state.previousVictimID)[0];return this.state.previousVictimID=t?t.id:null,t||(this.config.bondingTimes=0),t},t.prototype.detectFlagTaken=function(){this.state.flagCarrierID=null;var t=n($("#blueflag-name").html()),e=n($("#redflag-name").html());if(t||e){var s=Players.getMe(),i=Players.getByName(t);i&&i.team!==s.team&&(this.state.flagCarrierID=i.id);var o=Players.getByName(e);o&&o.team!==s.team&&(this.state.flagCarrierID=o.id)}function n(t){var e=/([^<]+)</.exec(t);return e?a.Spatie.decodeHtml(e[1]):null}},t.prototype.detectDangerousObjects=function(){if(this.state.objectToFleeFromID=null,!this.hasShield()){var t=this.state.missileIDs||[];this.state.missileIDs=[];for(var e=[],s=0;s<t.length;s++){var i=Mobs.get(t[s]);i&&(e.push(i),i.delta=null)}var o=this.config.fleeHealthThresholdMax/Players.getMe().health;if(e.length>0){var n=Players.getMe().pos;e.sort(function(t,e){var s=t.delta||a.Spatie.calcDiff(n,t.pos),i=e.delta||a.Spatie.calcDiff(n,e.pos);return t.delta=s,e.delta=i,s.distance<i.distance?-1:i.distance<s.distance?1:0});var r=e[0],c=r.delta||a.Spatie.calcDiff(n,r.pos),l=r.exhaust/18,h=this.config.distanceMissileDangerous*l*o;c.distance<h&&(this.state.objectToFleeFromID=r.id)}for(var u=e.map(function(t){return t.id}),p=0;p<u.length;p++)this.state.missileIDs.push(u[p]);if(!this.state.objectToFleeFromID){var d=this.state.victim?this.state.victim.id:null,f=this.getHostilePlayersSortedByDistance(d)[0];if(f){c=this.getDeltaTo(f),h=o*this.config.distanceTooClose;c.isAccurate&&c.distance<h&&(this.state.objectToFleeFromID=f.id)}}}},t.prototype.detectShouldFlee=function(){this.hasShield()||Players.getMe().health<this.config.fleeHealthThresholdMin&&(this.state.isFleeing=!0)},t.prototype.detectStuckness=function(){if(!this.state.isStuck){var t=Players.getMe(),e=t.speed;if(Math.abs(e.x)<1&&Math.abs(e.y)<1&&t.state.thrustLevel>0){if(this.state.stucknessTimeout?this.state.stucknessTimeout=this.state.stucknessTimeout-this.config.heartbeatInterval:this.state.stucknessTimeout=Date.now()+this.config.stucknessTimeoutMs,this.state.stucknessTimeout<=0){this.state.stucknessTimeout=null,this.state.isStuck=!0;var s=a.Spatie.getRandomNumber(0,250);this.state.stuckTimeStopTurning=Date.now()+this.config.stucknessTurnDurationMs-s,this.state.stuckTimeStopFlying=Date.now()+this.config.stucknessFlyDurationMs+s,this.state.detectedPowerUps&&this.state.detectedPowerUps.length>0&&(this.state.detectedPowerUps=null)}}else this.state.stucknessTimeout=this.state.stucknessTimeout+this.config.heartbeatInterval,this.state.stucknessTimeout>this.config.stucknessTimeoutMs&&(this.state.stucknessTimeout=null)}},t.prototype.detectVictimPowerUps=function(){this.state.isVictimPoweredUp=!1,this.state.victim&&(this.state.victim.powerups.rampage||this.state.victim.powerups.shield)&&(this.state.isVictimPoweredUp=!0)},t.prototype.fireAtVictim=function(){if(!this.config.holdFire)if(this.config.fireConstantly)this.setFire(!0,null);else{var t=this.state.isFleeing;if(!t)t=Players.getMe().powerups.rampage;if(!t)if(this.state.victim)t=this.getDeltaTo(this.state.victim).distance<this.config.distanceNear;var e=1e3;this.state.isFleeing&&(e=200),this.setFire(t,e)}},t.prototype.fleeFrom=function(t){var e=Players.getMe(),s=a.Spatie.calcDiff(e.pos,t.pos);if("WHOMP"===this.config.useSpecial&&e.energy>.4&&s.distance<this.config.distanceMissileDangerous)return this.setWhomp(),void a.Spatie.log("WHOMPING, energy level "+e.energy);var i=Math.atan2(s.diffX,s.diffY),o=Math.atan2(0,-1);i<0&&(i=2*o+i);var n,r=i-e.rot;Math.abs(r)>2*this.config.precision&&(n=r>0&&r<=o?"RIGHT":"LEFT"),this.setTurnMovement(n),this.setFastMovement(!0),this.setSpeedMovement("DOWN")},t.prototype.getDeltaTo=function(t){var e=!0,s=(t=t||this.state.victim).pos;t.lowResPos&&(s=(e=a.Spatie.calcDiff(t.lowResPos,t.pos).distance<this.config.distanceNear)?s:t.lowResPos);var o=Players.getMe().pos;return i({},a.Spatie.calcDiff(o,s),{isAccurate:e})},t.prototype.getHostilePlayersSortedByDistance=function(t){var e=this;void 0===t&&(t=null);var s=a.Spatie.getPlayers().filter(function(e){return e.team!==game.myTeam&&e.id!==t});return s.sort(function(t,s){var i=e.getDeltaTo(t),o=e.getDeltaTo(s);return i.isAccurate&&!o.isAccurate?-1:!i.isAccurate&&o.isAccurate?1:i.distance<o.distance?-1:o.distance<i.distance?1:0}),s},t.prototype.handleFlee=function(){if(Players.getMe().health>this.config.fleeHealthThresholdMax||this.hasShield())this.state.isFleeing=!1;else{var t=this.getHostilePlayersSortedByDistance()[0];if(t)this.getDeltaTo(t).distance>2*this.config.distanceFar?this.state.isFleeing=!1:this.fleeFrom(t);else this.state.isFleeing=!1}},t.prototype.handleObjectToFleeFrom=function(){var t=Mobs.get(this.state.objectToFleeFromID);t||(t=Players.get(this.state.objectToFleeFromID)),t&&!this.hasShield()&&this.fleeFrom(t)},t.prototype.handleStuckness=function(){var t=Date.now();if(t<this.state.stuckTimeStopTurning){if(!this.state.turnMovement){var e=["LEFT","RIGHT"][a.Spatie.getRandomNumber(0,2)];this.setTurnMovement(e)}this.setSpeedMovement("DOWN")}else t>=this.state.stuckTimeStopTurning&&t<this.state.stuckTimeStopFlying?(this.setTurnMovement(null),this.setSpeedMovement("UP")):t>=this.state.stuckTimeStopFlying&&(this.setSpeedMovement(null),this.state.isStuck=!1)},t.prototype.hasRampage=function(){return Players.getMe().powerups.rampage},t.prototype.hasShield=function(){return Players.getMe().powerups.shield},t.prototype.heartbeat=function(){this.state.previous=this.state.name,this.state.isStuck?(this.state.name="stuck",this.handleStuckness()):this.state.objectToFleeFromID?(this.state.name="flee from object",this.detectStuckness(),this.handleObjectToFleeFrom()):this.state.isFleeing?(this.state.name="low health flee",this.detectStuckness(),this.handleFlee()):this.state.detectedPowerUps&&this.state.detectedPowerUps.length>0?(this.state.name="chase mob",this.approachMob(),this.detectStuckness(),this.detectShouldFlee()):this.state.gotoCoords?(this.state.name="go to coords",this.approachCoords(),this.detectStuckness(),this.detectShouldFlee()):(this.state.name="chase victim "+(this.state.victim?this.state.victim.name:"-"),this.detectFlagTaken(),this.reconsiderVictim(),this.turnToVictim(),this.approachVictim(),this.fireAtVictim(),this.detectVictimPowerUps(),this.detectStuckness(),this.detectShouldFlee()),this.state.name!==this.state.previous&&a.Spatie.log(this.state.name),this.applyUpgrades(),this.commandExecutor.executeCommands(),this.detectDangerousObjects()},t.prototype.isOn=function(){return!!this.state},t.prototype.reconsiderVictim=function(){var t,e=!!this.state.victim;if(this.state.flagCarrierID)e=!1,t=Players.get(this.state.flagCarrierID);else{if(!(t=this.state.victim||this.chooseNextVictim()))return;var s=Date.now()-this.state.lastTimeVictimWasChosen,i=!!Players.get(t.id),o=t.removedFromMap,n=5===t.type,r=!!this.state.suggestedVictimID,c=!!/^test.*/.exec(t.name)||this.config.bondingTimes>0&&!!/^.+Bot.*/.exec(t.name),l=void 0;if(this.state.lastTimeVictimWasChosen&&(l=s>this.config.victimExpireMs),(!i||n||o||l||c)&&(t=null),r&&(a.Spatie.log("Victim was suggested: "+this.state.suggestedVictimID),e=!1,t=Players.get(this.state.suggestedVictimID),this.state.suggestedVictimID=null),t){var h=this.getHostilePlayersSortedByDistance()[0];if(h.id!==t.id){var u=this.getDeltaTo(t),p=this.getDeltaTo(h),d=void 0;!p.isAccurate||u.distance<this.config.distanceClose?d=!1:p.isAccurate&&!u.isAccurate?d=!0:p.distance/u.distance<.5&&(d=!0),d&&(t=h,e=!1)}}}var f=!!t;f!==e&&(e&&!f?a.Spatie.log("Dropped victim "+this.state.victim.name):f&&!e&&a.Spatie.log("Chose new victim "+t.name),this.state.lastTimeVictimWasChosen=Date.now()),this.state.victim=t?Players.get(t.id):null},t.prototype.setFire=function(t,e){void 0===e&&(e=null),this.state.isFiring=t,this.state.stopFiringTimeout=e},t.prototype.setTurnMovement=function(t){this.state.turnMovement=t},t.prototype.setSpeedMovement=function(t){this.state.speedMovement=t},t.prototype.setFastMovement=function(t){this.state.fast=t},t.prototype.setWhomp=function(){this.state.whomp=!0},t.prototype.turnTo=function(t){var e=this.getDeltaTo(t),s=Math.atan2(e.diffX,e.diffY),i=Math.atan2(0,-1);s<0&&(s=2*i+s);var o,a=s-Players.getMe().rot;Math.abs(a)>this.config.precision&&(o=a>0&&a<=i?"RIGHT":"LEFT"),this.setTurnMovement(o)},t.prototype.turnToVictim=function(){var t=this.state.victim;t&&this.turnTo(t)},t}();e.SpatieBot=h},function(t,e,s){"use strict";var i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,s=1,i=arguments.length;s<i;s++)for(var o in e=arguments[s])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var o=function(){return function(){}}();e.BotConfig=o;var a=function(){function t(){this.normalBotConfig={applyUpgradesTo:4,bondingTimes:0,distanceFar:600,distanceNear:450,distanceClose:300,distanceTooClose:200,distanceMissileDangerous:300,fleeHealthThresholdMin:.3,fleeHealthThresholdMax:.7,fireConstantly:!1,goForUpgrades:!0,heartbeatInterval:75,holdFire:!1,name:"normal",precision:.1,throttleInterval:150,respawnTimeout:4e3,stucknessTurnDurationMs:500,stucknessFlyDurationMs:2e3,stucknessTimeoutMs:1500,useSpecial:"SPEED",useStealth:!1,victimExpireMs:12e4},this.peacefulBotConfig=i({},this.normalBotConfig,{applyUpgradesTo:2,distanceFar:1200,distanceNear:850,distanceClose:600,distanceTooClose:400,fleeHealthThresholdMin:.5,fleeHealthThresholdMax:.9,goForUpgrades:!0,holdFire:!0,name:"peaceful",precision:.3}),this.agressiveBotConfig=i({},this.normalBotConfig,{applyUpgradesTo:4,distanceTooClose:50,distanceMissileDangerous:50,fireConstantly:!0,fleeHealthThresholdMin:.2,fleeHealthThresholdMax:.5,name:"agressive",precision:.15,stucknessTimeoutMs:1e3}),this.copterBotConfig=i({},this.normalBotConfig,{applyUpgradesTo:2,distanceTooClose:400,distanceMissileDangerous:400,fireConstantly:!0,fleeHealthThresholdMin:.5,fleeHealthThresholdMax:.9,name:"copter",useSpecial:null}),this.tornadoBotConfig=i({},this.normalBotConfig,{applyUpgradesTo:1,distanceTooClose:100,distanceMissileDangerous:200,fleeHealthThresholdMin:.5,fleeHealthThresholdMax:.9,name:"tornado",useSpecial:"FIRE"}),this.prowlerBotConfig=i({},this.normalBotConfig,{distanceNear:300,distanceClose:200,distanceTooClose:50,distanceMissileDangerous:200,name:"prowler",useStealth:!0,useSpecial:"STEALTH"}),this.goliathBotConfig=i({},this.normalBotConfig,{applyUpgradesTo:1,distanceNear:500,distanceClose:300,distanceTooClose:150,distanceMissileDangerous:280,fleeHealthThresholdMin:.2,fleeHealthThresholdMax:.4,name:"goliath",useSpecial:"WHOMP"})}return t.prototype.getConfigByName=function(t){var e=this.normalBotConfig;switch(t){case"peaceful":e=this.peacefulBotConfig;break;case"agressive":e=this.agressiveBotConfig;break;case"copter":e=this.copterBotConfig;break;case"tornado":e=this.tornadoBotConfig;break;case"prowler":e=this.prowlerBotConfig;break;case"goliath":e=this.goliathBotConfig}return e},t.prototype.getConfigByAircraftType=function(t){switch(t){case 1:return this.agressiveBotConfig;case 2:return this.goliathBotConfig;case 3:return this.copterBotConfig;case 4:return this.tornadoBotConfig;case 5:return this.prowlerBotConfig;default:return this.normalBotConfig}},t}();e.BotConfigFactory=a},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){return function(){}}();e.SpatiebotState=i},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s(0),o=function(){function t(t,e){this.state=t,this.config=e}return t.prototype.clearCommands=function(){Network.sendKey("LEFT",!1),Network.sendKey("RIGHT",!1),Network.sendKey("UP",!1),Network.sendKey("DOWN",!1),Network.sendKey("FIRE",!1),Network.sendKey("SPECIAL",!1)},t.prototype.executeCommands=function(){var t,e,s=this,o=this.state.previousTurnMovement!==this.state.turnMovement,a=this.state.previousSpeedMovement!==this.state.speedMovement,n=!this.state.nextMovementExec||Date.now()>this.state.nextMovementExec,r=this.state.previousIsFiring!==this.state.isFiring;if("WHOMP"===this.config.useSpecial&&(t=this.state.previousWhomp!==this.state.whomp),"SPEED"===this.config.useSpecial&&(e=this.state.previousFast!==this.state.fast),n||o||a||e||r||t){if(a&&(this.state.previousSpeedMovement&&Network.sendKey(this.state.previousSpeedMovement,!1),this.state.previousSpeedMovement=this.state.speedMovement),o&&(this.state.previousTurnMovement&&Network.sendKey(this.state.previousTurnMovement,!1),this.state.previousTurnMovement=this.state.turnMovement),e&&(this.state.previousFast=this.state.fast),r&&(this.state.previousIsFiring=this.state.isFiring),this.state.turnMovement&&(o||n)&&Network.sendKey(this.state.turnMovement,!0),this.state.speedMovement&&(a||n)&&Network.sendKey(this.state.speedMovement,!0),"SPEED"===this.config.useSpecial&&(e||n)&&(this.state.fast?this.state.fastTimeout||(Network.sendKey("SPECIAL",!0),this.state.fastTimeout=setTimeout(function(){Network.sendKey("SPECIAL",!1),s.state.fastTimeout=null},1e3)):Network.sendKey("SPECIAL",!1)),r||n){var c="FIRE";if("FIRE"===this.config.useSpecial&&(c="SPECIAL"),this.state.isFiring){if(!this.state.fireTimeout&&(Network.sendKey(c,!0),!this.config.fireConstantly)){var l=this.state.stopFiringTimeout||1e3;this.state.fireTimeout=setTimeout(function(){Network.sendKey(c,!1),s.state.fireTimeout=null},l)}}else Network.sendKey(c,!1)}var h=!1;this.config.useStealth&&"STEALTH"===this.config.useSpecial&&!Players.getMe().stealthed&&(h=!0),t&&(h=!0,this.state.whomp=!1,this.state.previousWhomp=!1),h&&(i.Spatie.log("Sending special"),Network.sendKey("SPECIAL",!0),setTimeout(function(){return Network.sendKey("SPECIAL",!1)},100)),this.state.nextMovementExec=Date.now()+this.config.throttleInterval}},t}();e.SpatiebotCommandExecutor=o}]);